<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Adhurjya Store — All-in-one Toolbox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="description" content="Adhurjya Store — client-side toolbox for photos, PDFs, and media." />

  <!-- ✅ ADDED: AI-Optimized meta keywords -->
  <meta name="keywords" content="Adhurjya Store, Adhurjya tools, photo to PDF converter, image compressor, PDF compressor, merge PDF online, PDF to image, image to text, OCR Bengali, OCR Hindi, OCR English, Bengali OCR online, Hindi OCR online, ID photo maker, passport size photo maker, document tools India, free PDF tools, browser tools, client-side tools, offline PDF tools, AI photo enhancer, image resizer, image format converter" />

  <!-- ✅ ADDED: Favicon + Manifest SEO boost (files later create korte hobe) -->
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- ✅ ADDED: Performance / PageSpeed tags -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="//www.highperformanceformat.com" />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />

  <!-- ✅ ADDED: Sitemap (later sitemap.xml banale kaj korbe) -->
  <link rel="sitemap" type="application/xml" title="Sitemap" href="https://adhurjyatools.in/sitemap.xml" />

  <!-- ✅ ADDED: OpenGraph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Adhurjya Store" />
  <meta property="og:url" content="https://adhurjyatools.in/" />
  <meta property="og:title" content="Adhurjya Store — All-in-one Browser Toolbox" />
  <meta property="og:description" content="Convert, compress and enhance your photos & PDFs directly in your browser. No uploads, no login, just pure client-side magic." />
  <meta property="og:image" content="https://adhurjyatools.in/og-image.jpg" />

  <!-- ✅ ADDED: Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Adhurjya Store — All-in-one Browser Toolbox" />
  <meta name="twitter:description" content="Convert, compress and enhance your photos & PDFs directly in your browser. No uploads, no login." />
  <meta name="twitter:image" content="https://adhurjyatools.in/og-image.jpg" />

  <!-- ✅ ADDED: JSON-LD Schema (WebSite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Adhurjya Store",
    "url": "https://adhurjyatools.in/",
    "description": "Adhurjya Store is an all-in-one browser toolbox for photos and PDFs — photo to PDF, image compressor, PDF tools, OCR (English, Hindi, Bengali) and ID photo maker, all 100% client-side.",
    "inLanguage": "en-IN",
    "isAccessibleForFree": true,
    "publisher": {
      "@type": "Organization",
      "name": "Adhurjya Store",
      "url": "https://adhurjyatools.in/"
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://adhurjyatools.in/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    },
    "about": {
      "@type": "Thing",
      "name": "Online photo and PDF tools",
      "description": "Client-side tools for photo to PDF, image compression, PDF compression and merging, OCR in English, Hindi and Bengali, PDF to image, image resize and ID photo creation."
    }
  }
  </script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- External Libraries (UMD globals) -->
  <!-- pdf-lib -->
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <!-- Tesseract.js -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
  <!-- pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <!-- ONNX Runtime Web (for U²-Net human segmentation, future use) -->
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>

<style>
  :root{
    --bg:#020617;
    --bg-soft:#030712;
    --card:#020b29;
    --accent:#22c55e;
    --accent-soft:rgba(34,197,94,0.18);
    --accent-strong:#22c55e;
    --danger:#fb7185;
    --danger-soft:rgba(248,113,113,0.12);
    --border:#1f2937;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --radius:16px;
    --shadow-soft:0 18px 40px rgba(15,23,42,0.65);
    --shadow-strong:0 24px 60px rgba(15,23,42,0.95);
    --transition:all 0.18s ease-out;
  }

  *{box-sizing:border-box;}
  html,body{
    margin:0;
    padding:0;
    height:100%;
    scroll-behavior:smooth;
  }

  /* ✨ New background: layered gradients + glow strip */
  body{
    font-family:"Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    background:
      radial-gradient(circle at 0% 0%, rgba(59,130,246,0.25), transparent 55%),
      radial-gradient(circle at 80% 0%, rgba(16,185,129,0.28), transparent 55%),
      radial-gradient(circle at 10% 100%, rgba(129,140,248,0.22), transparent 60%),
      linear-gradient(145deg,#020617,#020617 40%,#020b25 80%,#020617 100%);
    color:var(--text);
  }

  header{
    position:sticky;
    top:0;
    z-index:50;
    backdrop-filter:blur(20px);
    -webkit-backdrop-filter:blur(20px);
    background:
      linear-gradient(to right,rgba(15,23,42,0.96),rgba(15,23,42,0.9)),
      linear-gradient(120deg,rgba(56,189,248,0.16),rgba(34,197,94,0.08));
    border-bottom:1px solid rgba(148,163,184,0.2);
    box-shadow:0 12px 40px rgba(15,23,42,0.8);
  }
  .header-inner{
    max-width:1080px;
    margin:0 auto;
    padding:0.85rem 1rem;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:0.5rem;
  }
  .logo{
    display:flex;
    align-items:center;
    gap:0.7rem;
  }
  .logo-icon{
    width:36px;
    height:36px;
    border-radius:999px;
    background:
      radial-gradient(circle at 25% 15%,#a5f3fc 0,#22c55e 35%,#14b8a6 60%,#020617 100%);
    box-shadow:
      0 0 24px rgba(34,197,94,0.75),
      0 0 40px rgba(56,189,248,0.45);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    font-weight:700;
    color:#020617;
  }
  .logo-title{
    font-weight:700;
    font-size:1.08rem;
    letter-spacing:0.03em;
  }
  .logo-sub{
    font-size:0.72rem;
    color:var(--muted);
  }
  .pill{
    font-size:0.7rem;
    padding:0.28rem 0.7rem;
    border-radius:999px;
    background:radial-gradient(circle at 0 0,rgba(52,211,153,0.3),rgba(15,23,42,0.98));
    border:1px solid rgba(52,211,153,0.6);
    color:#e5e7eb;
    display:flex;
    align-items:center;
    gap:0.35rem;
    box-shadow:0 0 22px rgba(16,185,129,0.55);
  }
  .pill-dot{
    width:8px;
    height:8px;
    border-radius:999px;
    background:var(--accent);
    box-shadow:0 0 12px rgba(34,197,94,1);
  }

  main{
    max-width:1080px;
    margin:0 auto;
    padding:1rem 1rem 2.5rem;
  }

  /* Home / hero */
  #home-section{
    padding-top:1.2rem;
    padding-bottom:2.2rem;
  }
  .hero{
    margin-bottom:1.6rem;
    display:flex;
    flex-direction:column;
    gap:0.6rem;
  }
  .hero-title{
    font-size:1.55rem;
    font-weight:650;
    letter-spacing:0.02em;
    text-shadow:0 10px 26px rgba(15,23,42,0.95);
  }
  .hero-sub{
    font-size:0.9rem;
    color:var(--muted);
    max-width:560px;
  }
  .hero-badges{
    display:flex;
    flex-wrap:wrap;
    gap:0.45rem;
    margin-top:0.3rem;
  }
  .hero-badge{
    font-size:0.7rem;
    padding:0.25rem 0.7rem;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.55);
    color:var(--muted);
    background:rgba(15,23,42,0.85);
    backdrop-filter:blur(14px);
  }

  /* Grid of tools */
  .tool-grid{
    display:grid;
    grid-template-columns:1fr;
    gap:1rem;
    margin-top:0.9rem;
  }
  @media(min-width:720px){
    .tool-grid{
      grid-template-columns:repeat(3,minmax(0,1fr));
    }
  }

  .tool-card{
    position:relative;
    background:
      linear-gradient(135deg,rgba(15,23,42,0.96),rgba(15,23,42,0.98)),
      radial-gradient(circle at 0 0,rgba(56,189,248,0.28),transparent 55%);
    border-radius:var(--radius);
    border:1px solid rgba(148,163,184,0.28);
    padding:0.85rem 0.9rem 0.95rem;
    box-shadow:var(--shadow-soft);
    display:flex;
    flex-direction:column;
    gap:0.4rem;
    overflow:hidden;
    transform:translateY(0) scale(1);
    transition:var(--transition), box-shadow 0.22s ease-out;
  }
  .tool-card::before{
    content:"";
    position:absolute;
    inset:-40%;
    background:radial-gradient(circle at 0 0,rgba(56,189,248,0.24),transparent 60%);
    opacity:0;
    transition:opacity 0.3s ease-out, transform 0.3s ease-out;
    transform:translate3d(-10px,-10px,0);
    pointer-events:none;
  }
  .tool-card:hover{
    transform:translateY(-4px) scale(1.01);
    box-shadow:var(--shadow-strong);
    border-color:rgba(148,163,184,0.5);
  }
  .tool-card:hover::before{
    opacity:1;
  }
  .tool-card h3{
    margin:0;
    font-size:0.98rem;
    font-weight:600;
  }
  .tool-card p{
    margin:0;
    font-size:0.78rem;
    color:var(--muted);
  }
  .tool-tags{
    display:flex;
    flex-wrap:wrap;
    gap:0.25rem;
    margin-top:0.15rem;
  }
  .tool-tag{
    font-size:0.65rem;
    padding:0.16rem 0.5rem;
    border-radius:999px;
    background:rgba(15,23,42,0.96);
    border:1px solid rgba(148,163,184,0.4);
    color:var(--muted);
  }

  /* Buttons */
  .btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:0.35rem;
    padding:0.5rem 1rem;
    border-radius:999px;
    border:none;
    font-size:0.78rem;
    font-weight:500;
    cursor:pointer;
    background:linear-gradient(135deg,#22c55e,#2dd4bf);
    color:#020617;
    box-shadow:0 14px 28px rgba(16,185,129,0.5);
    transition:var(--transition), box-shadow 0.22s ease-out;
  }
  .btn:hover{
    transform:translateY(-1px) scale(1.02);
    box-shadow:0 18px 40px rgba(16,185,129,0.7);
  }
  .btn:active{
    transform:translateY(0) scale(0.98);
    box-shadow:0 10px 22px rgba(16,185,129,0.4);
  }
  .btn-outline{
    background:rgba(15,23,42,0.96);
    color:var(--muted);
    border:1px solid rgba(148,163,184,0.55);
    box-shadow:none;
  }
  .btn-outline:hover{
    background:rgba(15,23,42,1);
    color:#e5e7eb;
    box-shadow:0 16px 36px rgba(15,23,42,0.9);
  }

  /* Tool panels (inner screens) */
  .tool-panel{
    display:none;
    background:
      linear-gradient(145deg,rgba(15,23,42,0.96),rgba(15,23,42,0.98)),
      radial-gradient(circle at 0 0,rgba(56,189,248,0.24),transparent 60%);
    border-radius:var(--radius);
    border:1px solid rgba(148,163,184,0.3);
    padding:0.9rem 1rem 1.15rem;
    margin-bottom:1.4rem;
    box-shadow:var(--shadow-strong);
    backdrop-filter:blur(22px);
    -webkit-backdrop-filter:blur(22px);
  }
  .tool-header{
    display:flex;
    justify-content:space-between;
    gap:0.7rem;
    align-items:center;
    margin-bottom:0.7rem;
  }
  .tool-header h2{
    margin:0;
    font-size:1.02rem;
    font-weight:600;
  }
  .tool-header p{
    margin:0.2rem 0 0;
    font-size:0.78rem;
    color:var(--muted);
  }

  .section{
    margin-top:0.65rem;
    padding-top:0.55rem;
    border-top:1px solid rgba(148,163,184,0.22);
  }
  .section-title{
    font-size:0.86rem;
    font-weight:600;
    margin-bottom:0.35rem;
  }

  .field{
    display:flex;
    flex-direction:column;
    gap:0.22rem;
    margin-bottom:0.5rem;
    font-size:0.8rem;
  }
  .field label{
    font-weight:500;
  }
  .field small{
    font-size:0.7rem;
    color:var(--muted);
  }

  input[type="file"],
  input[type="number"],
  input[type="text"],
  input[type="range"],
  select,
  textarea{
    background:rgba(15,23,42,0.96);
    border-radius:0.65rem;
    border:1px solid rgba(55,65,81,0.9);
    padding:0.35rem 0.55rem;
    color:var(--text);
    font-family:inherit;
    font-size:0.78rem;
    outline:none;
    transition:border-color 0.16s ease-out, box-shadow 0.16s ease-out, background 0.16s;
  }
  input[type="file"]{padding:0.42rem;}
  input[type="range"]{padding:0;accent-color:#22c55e;}
  textarea{
    min-height:110px;
    resize:vertical;
  }
  input:focus,
  select:focus,
  textarea:focus{
    border-color:var(--accent-strong);
    box-shadow:0 0 0 1px rgba(34,197,94,0.4);
    background:rgba(15,23,42,1);
  }

  .hint{
    font-size:0.7rem;
    color:var(--muted);
  }
  .status{
    margin-top:0.35rem;
    font-size:0.75rem;
    color:var(--muted);
  }
  .status.error{
    color:#fecaca;
    background:var(--danger-soft);
    border-radius:0.55rem;
    padding:0.28rem 0.45rem;
    border:1px solid rgba(248,113,113,0.4);
  }
  .status.success{
    color:#bbf7d0;
    background:var(--accent-soft);
    border-radius:0.55rem;
    padding:0.28rem 0.45rem;
    border:1px solid rgba(34,197,94,0.4);
  }

  .thumb-list{
    display:flex;
    flex-direction:column;
    gap:0.35rem;
    margin-top:0.35rem;
    max-height:230px;
    overflow:auto;
    padding-right:0.2rem;
  }
  .thumb-item{
    display:flex;
    align-items:center;
    gap:0.45rem;
    padding:0.35rem 0.5rem;
    border-radius:0.8rem;
    background:rgba(15,23,42,0.96);
    border:1px solid rgba(55,65,81,0.9);
  }
  .thumb-item img{
    width:48px;
    height:48px;
    object-fit:cover;
    border-radius:0.55rem;
  }
  .thumb-meta{
    flex:1;
    min-width:0;
  }
  .thumb-meta div{
    font-size:0.75rem;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .thumb-meta small{
    font-size:0.68rem;
    color:var(--muted);
  }
  .thumb-actions{
    display:flex;
    flex-direction:column;
    gap:0.22rem;
  }

  .icon-btn{
    width:22px;
    height:22px;
    border-radius:999px;
    border:1px solid rgba(75,85,99,0.9);
    background:rgba(15,23,42,0.98);
    color:var(--muted);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:0.6rem;
    cursor:pointer;
    padding:0;
    transition:var(--transition);
  }
  .icon-btn:hover:not(:disabled){
    background:rgba(31,41,55,1);
    color:#e5e7eb;
  }
  .icon-btn:disabled{
    opacity:0.35;
    cursor:default;
  }

  .preview-img{
    max-width:100%;
    border-radius:0.8rem;
    border:1px solid rgba(55,65,81,0.9);
    background:rgba(15,23,42,0.96);
    display:block;
  }
  .preview-row{
    display:flex;
    flex-direction:column;
    gap:0.6rem;
  }
  @media(min-width:720px){
    .preview-row{
      flex-direction:row;
      align-items:flex-start;
    }
  }

  .flex{display:flex;}
  .flex-between{display:flex;justify-content:space-between;align-items:center;}
  .flex-wrap{flex-wrap:wrap;}
  .gap-xs{gap:0.25rem;}
  .gap-sm{gap:0.4rem;}
  .gap-md{gap:0.6rem;}
  .mt-xs{margin-top:0.25rem;}
  .mt-sm{margin-top:0.4rem;}
  .mt-md{margin-top:0.7rem;}

  .badge-soft{
    font-size:0.7rem;
    padding:0.18rem 0.55rem;
    border-radius:999px;
    background:rgba(15,23,42,0.96);
    border:1px dashed rgba(148,163,184,0.45);
    color:var(--muted);
  }

  .download-link{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding:0.45rem 0.9rem;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.5);
    font-size:0.78rem;
    margin-top:0.35rem;
    background:rgba(15,23,42,0.98);
    color:var(--text);
    text-decoration:none;
    transition:var(--transition);
  }
  .download-link:hover{
    background:rgba(15,23,42,1);
    box-shadow:0 12px 30px rgba(15,23,42,0.9);
  }

  .pill-small{
    font-size:0.66rem;
    padding:0.1rem 0.45rem;
    border-radius:999px;
    background:rgba(15,23,42,0.94);
    border:1px solid rgba(148,163,184,0.4);
    color:var(--muted);
  }

  /* ID photo cropper */
  .id-crop-wrapper{
    position:relative;
    border-radius:0.9rem;
    overflow:hidden;
    border:1px solid rgba(55,65,81,0.95);
    background:#020617;
    max-height:350px;
  }
  .id-crop-img{
    width:100%;
    display:block;
  }
  .crop-rect{
    position:absolute;
    border:2px solid rgba(34,197,94,0.95);
    box-shadow:0 0 0 100vmax rgba(15,23,42,0.68);
    cursor:move;
    border-radius:0.45rem;
  }
  .crop-rect::after{
    content:"Drag to adjust";
    position:absolute;
    left:50%;
    bottom:-18px;
    transform:translateX(-50%);
    font-size:0.65rem;
    color:var(--muted);
    background:rgba(15,23,42,0.96);
    padding:0.08rem 0.4rem;
    border-radius:999px;
    border:1px solid rgba(55,65,81,0.9);
  }

  .progress-bar{
    width:100%;
    height:6px;
    border-radius:999px;
    background:rgba(15,23,42,0.96);
    overflow:hidden;
    margin-top:0.25rem;
  }
  .progress-inner{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#22c55e,#2dd4bf,#38bdf8);
    transition:width 0.1s linear;
  }

  .divider{
    height:1px;
    width:100%;
    background:rgba(148,163,184,0.3);
    margin:0.55rem 0;
  }

  .mode-pill{
    display:inline-flex;
    align-items:center;
    gap:0.3rem;
    padding:0.2rem 0.65rem;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.55);
    background:rgba(15,23,42,0.94);
    font-size:0.72rem;
    cursor:pointer;
  }
  .mode-pill input{margin:0;}

  /* ADSTERRA ad box */
  .ad-box-300x250{
    margin: 1.2rem 0 0.8rem;
    display:flex;
    justify-content:center;
  }
  .ad-box-300x250-inner{
    width:300px;
    height:250px;
    max-width:100%;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 18px 40px rgba(15,23,42,0.8);
    background:#020617;
  }

  /* ✅ ADDED: Trust & E-E-A-T section */
  .trust-section{
    margin-top:2.2rem;
    padding:1.2rem 1rem 1.4rem;
    border-radius:var(--radius);
    background:
      linear-gradient(145deg,rgba(15,23,42,0.98),rgba(15,23,42,0.99)),
      radial-gradient(circle at 0 0,rgba(56,189,248,0.18),transparent 55%);
    border:1px solid rgba(148,163,184,0.35);
    box-shadow:var(--shadow-soft);
  }
  .trust-title{
    font-size:0.98rem;
    font-weight:600;
    margin-bottom:0.4rem;
  }
  .trust-sub{
    font-size:0.78rem;
    color:var(--muted);
    margin-bottom:0.7rem;
  }
  .trust-grid{
    display:grid;
    grid-template-columns:1fr;
    gap:0.7rem;
    margin-bottom:0.8rem;
  }
  @media(min-width:720px){
    .trust-grid{
      grid-template-columns:repeat(3,minmax(0,1fr));
    }
  }
  .trust-card{
    padding:0.7rem 0.7rem;
    border-radius:0.9rem;
    background:rgba(15,23,42,0.96);
    border:1px solid rgba(55,65,81,0.9);
    font-size:0.76rem;
  }
  .trust-card strong{
    display:block;
    margin-bottom:0.25rem;
    font-size:0.8rem;
  }
  .trust-footer{
    font-size:0.72rem;
    color:var(--muted);
    border-top:1px dashed rgba(148,163,184,0.35);
    padding-top:0.5rem;
  }
</style>

</head>
<body>
<header>
  <div class="header-inner">
    <div class="logo">
      <div class="logo-icon">A</div>
      <div>
        <div class="logo-title">Adhurjya Store</div>
        <div class="logo-sub">All-in-one browser toolbox • 100% client-side</div>
      </div>
    </div>
    <div class="pill">
      <span class="pill-dot"></span>
      <span>Runs offline in your browser</span>
    </div>
  </div>
</header>

<main>
  <!-- HOME / TOOL GRID -->
  <section id="home-section">
    <div class="hero">
      <div class="hero-title">Choose a tool to get started</div>
      <div class="hero-sub">
        Convert, compress and enhance your photos & PDFs directly in your browser. No uploads, no login, just pure client-side magic.
      </div>
      <div class="hero-badges">
        <span class="hero-badge">Photo → PDF</span>
        <span class="hero-badge">PDF tools</span>
        <span class="hero-badge">OCR & utilities</span>
        <span class="hero-badge">AI-style enhancers & ID photos</span>
      </div>
    </div> <!-- .hero end -->

    <!-- ADSTERRA 300x250_1 – hero niche main ad -->
    <div class="ad-box-300x250">
      <div class="ad-box-300x250-inner">
        <script type="text/javascript">
        atOptions = {
            'key' : '05bc1f9edafb9b6108cdf31d22d1dad2',
            'format' : 'iframe',
            'height' : 250,
            'width' : 300,
            'params' : {}
        };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/05bc1f9edafb9b6108cdf31d22d1dad2/invoke.js"></script>
      </div>
    </div>


    <!-- GRID of tools -->
    <div class="tool-grid">

      <div class="tool-card">
        <h3>Photo → PDF Converter</h3>
        <p>Combine multiple photos into a single high-quality PDF with size-friendly compression.</p>
        <div class="tool-tags">
          <span class="tool-tag">JPG/PNG</span>
          <span class="tool-tag">Multi-page</span>
        </div>
        <button class="btn" onclick="openTool('photo-pdf')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Photo Size Compressor</h3>
        <p>Shrink image file size with adjustable quality and max dimensions.</p>
        <div class="tool-tags">
          <span class="tool-tag">Compress</span>
        </div>
        <button class="btn" onclick="openTool('photo-compress')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Image Resizer</h3>
        <p>Resize images to exact width/height while keeping aspect ratio if needed.</p>
        <div class="tool-tags">
          <span class="tool-tag">Resize</span>
        </div>
        <button class="btn" onclick="openTool('image-resize')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Photo / PDF → Excel</h3>
        <p>Table-style text extract করে CSV বানাও – marksheet, attendance, expense ইত্যাদি জন্য।</p>
        <div class="tool-tags">
          <span class="tool-tag">OCR</span>
          <span class="tool-tag">Table → CSV</span>
        </div>
        <button class="btn" onclick="openTool('photo-excel')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Image to Text (OCR)</h3>
        <p>Extract text from images or PDFs using Tesseract.js — English + Hindi/Bengali.</p>
        <div class="tool-tags">
          <span class="tool-tag">OCR</span>
          <span class="tool-tag">Image + PDF</span>
        </div>
        <button class="btn" onclick="openTool('ocr')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>PDF Compressor</h3>
        <p>Re-render PDF pages as compressed images to reduce size.</p>
        <div class="tool-tags">
          <span class="tool-tag">PDF</span>
        </div>
        <button class="btn" onclick="openTool('pdf-compress')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Merge PDF</h3>
        <p>Combine multiple PDF files into a single document.</p>
        <div class="tool-tags">
          <span class="tool-tag">Merge</span>
        </div>
        <button class="btn" onclick="openTool('pdf-merge')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>PDF to Image</h3>
        <p>Convert PDF pages into downloadable images.</p>
        <div class="tool-tags">
          <span class="tool-tag">PDF → PNG/JPG</span>
        </div>
        <button class="btn" onclick="openTool('pdf-to-image')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>Image Format Converter</h3>
        <p>Convert between JPG, PNG and WEBP formats.</p>
        <div class="tool-tags">
          <span class="tool-tag">Format</span>
        </div>
        <button class="btn" onclick="openTool('image-format')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>AI Photo Enhancer</h3>
        <p>Brightness, contrast, saturation & sharpness with Auto Enhance.</p>
        <div class="tool-tags">
          <span class="tool-tag">Enhance</span>
        </div>
        <button class="btn" onclick="openTool('photo-enhance')">Open Tool</button>
      </div>

      <div class="tool-card">
        <h3>ID Photo Maker</h3>
        <p>Passport-style ID photo with background color & multi copies.</p>
        <div class="tool-tags">
          <span class="tool-tag">ID / Passport</span>
        </div>
        <button class="btn" onclick="openTool('id-photo')">Open Tool</button>
      </div>

    </div> <!-- .tool-grid end -->
  </section>

  <!-- 1. Photo → PDF Converter -->
  <section id="panel-photo-pdf" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Photo → PDF Converter</h2>
        <p>Combine multiple photos into a single high-quality PDF.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>

    <div class="section">
      <div class="field">
        <label>Select photos (in order)</label>
        <input id="photoPdf-input" type="file" accept="image/*" multiple />
        <small>You can reorder photos below before making the PDF.</small>
      </div>

      <div class="field">
        <label>Max longer side (px)</label>
        <input id="photoPdf-maxDim" type="number" min="600" max="3000" value="1600" />
        <small>Images will be scaled down if larger than this.</small>
      </div>

      <div class="field">
        <label>JPEG quality</label>
        <input id="photoPdf-quality" type="range" min="0.3" max="1" step="0.05" value="0.7" />
        <small>Balance between quality &amp; size.</small>
      </div>

      <button class="btn mt-sm" onclick="generatePhotoPdf()">Generate PDF</button>

      <div id="photoPdf-status" class="status mt-xs"></div>

      <a id="photoPdf-download" class="download-link" href="#" style="display:none;" download="photos.pdf">
        ⬇ Download PDF
      </a>

      <div class="divider"></div>
      <div class="section-title">Selected photos</div>
      <div id="photoPdf-list" class="thumb-list"></div>
    </div>
  </section>

  <!-- 2. Photo Size Compressor -->
  <section id="panel-photo-compress" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Photo Size Compressor</h2>
        <p>Compress an image with adjustable quality and optional max size.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select image</label>
        <input id="compress-input" type="file" accept="image/*" />
      </div>
      <div class="flex flex-wrap gap-sm">
        <div class="field" style="flex:1 1 120px;max-width:180px;">
          <label>Quality</label>
          <input id="compress-quality" type="range" min="0.2" max="1" step="0.05" value="0.7" />
          <small><span id="compress-quality-label">70</span>%</small>
        </div>
        <div class="field" style="flex:1 1 120px;max-width:180px;">
          <label>Max width (px, optional)</label>
          <input id="compress-maxW" type="number" min="200" max="4000" placeholder="e.g. 1600" />
        </div>
        <div class="field" style="flex:1 1 120px;max-width:180px;">
          <label>Max height (px, optional)</label>
          <input id="compress-maxH" type="number" min="200" max="4000" placeholder="e.g. 1600" />
        </div>
      </div>
      <button class="btn mt-sm" onclick="compressPhoto()">Compress Image</button>
      <div class="status mt-xs">
        Original: <span id="compress-original-size">–</span> KB • Compressed: <span id="compress-new-size">–</span> KB
      </div>
      <a id="compress-download" class="download-link" href="#" style="display:none;" download="compressed.jpg">⬇ Download compressed image</a>
      <div class="divider"></div>
      <div class="section-title">Preview</div>
      <div class="preview-row">
        <div style="flex:1;">
          <div class="pill-small">Original</div>
          <img id="compress-original-preview" class="preview-img mt-xs" alt="" />
        </div>
        <div style="flex:1;">
          <div class="pill-small">Compressed</div>
          <img id="compress-new-preview" class="preview-img mt-xs" alt="" />
        </div>
      </div>
    </div>
  </section>

  <!-- 3. Image Resizer -->
  <section id="panel-image-resize" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Image Resizer</h2>
        <p>Resize images to specific dimensions with optional aspect ratio lock.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select image</label>
        <input id="resize-input" type="file" accept="image/*" />
      </div>
      <div class="flex flex-wrap gap-sm mt-xs">
        <div class="field" style="flex:1 1 90px;max-width:150px;">
          <label>Width (px)</label>
          <input id="resize-width" type="number" min="10" />
        </div>
        <div class="field" style="flex:1 1 90px;max-width:150px;">
          <label>Height (px)</label>
          <input id="resize-height" type="number" min="10" />
        </div>
        <div class="field" style="flex:1 1 90px;max-width:160px;">
          <label>
            <input id="resize-keep-aspect" type="checkbox" checked />
            Keep aspect ratio
          </label>
        </div>
      </div>
      <button class="btn mt-sm" onclick="resizeImage()">Resize Image</button>
      <div id="resize-status" class="status"></div>
      <a id="resize-download" class="download-link" href="#" style="display:none;" download="resized.png">⬇ Download resized image</a>
      <div class="divider"></div>
      <div class="section-title">Preview</div>
      <div class="preview-row">
        <div style="flex:1;">
          <div class="pill-small">Original</div>
          <img id="resize-original-preview" class="preview-img mt-xs" alt="" />
        </div>
        <div style="flex:1;">
          <div class="pill-small">Resized</div>
          <img id="resize-new-preview" class="preview-img mt-xs" alt="" />
        </div>
      </div>
    </div>
  </section>

  <!-- 5. OCR -->
  <section id="panel-ocr" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Image to Text (OCR)</h2>
        <p>Use Tesseract.js to extract text from images or PDFs.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select image or PDF with text</label>
        <input id="ocr-input" type="file" accept="image/*,application/pdf" />
      </div>
      <div class="field">
        <label>Language</label>
        <select id="ocr-lang">
          <option value="eng">English (eng)</option>
          <option value="hin">Hindi (hin)</option>
          <option value="ben">Bengali (ben)</option>
        </select>
        <small>Hindi/Bengali need online language data, so internet may be required for first run.</small>
      </div>
      <button class="btn mt-sm" onclick="runOcr()">Run OCR</button>
      <div id="ocr-status" class="status"></div>
      <div class="progress-bar" style="display:none;" id="ocr-progress-bar">
        <div class="progress-inner" id="ocr-progress-inner"></div>
      </div>
      <div class="section mt-md">
        <div class="section-title">Recognized text</div>
        <textarea id="ocr-output" placeholder="Your extracted text will appear here... (multi-page PDFs will be combined with page breaks)"></textarea>
        <button class="btn btn-outline mt-xs" onclick="copyOcrText()">Copy Text</button>
      </div>
    </div>
  </section>

  <!-- 6. PDF Compressor -->
  <section id="panel-pdf-compress" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>PDF Compressor</h2>
        <p>Re-render pages as compressed images and rebuild a smaller PDF.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select PDF</label>
        <input id="pdfc-input" type="file" accept="application/pdf" />
      </div>
      <div class="field">
        <label>Quality preset</label>
        <select id="pdfc-quality">
          <option value="high">High (better quality, larger)</option>
          <option value="medium" selected>Medium</option>
          <option value="small">Small (smaller size)</option>
        </select>
      </div>
      <button class="btn mt-sm" onclick="compressPdf()">Compress PDF</button>
      <div id="pdfc-status" class="status"></div>
      <a id="pdfc-download" class="download-link" href="#" style="display:none;" download="compressed.pdf">⬇ Download compressed PDF</a>
      <div class="hint mt-xs">Note: This is a simplified client-side compressor. Very large PDFs may be slow or may fail on low-RAM devices.</div>
    </div>
  </section>

  <!-- 7. Merge PDF -->
  <section id="panel-pdf-merge" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Merge PDF</h2>
        <p>Combine multiple PDF files into a single document.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select PDFs</label>
        <input id="merge-input" type="file" accept="application/pdf" multiple />
      </div>
      <div id="merge-list" class="thumb-list"></div>
      <button class="btn mt-sm" onclick="mergePdfs()">Merge PDFs</button>
      <div id="merge-status" class="status"></div>
      <a id="merge-download" class="download-link" href="#" style="display:none;" download="merged.pdf">⬇ Download merged PDF</a>
    </div>
  </section>

  <!-- 8. PDF to Image -->
  <section id="panel-pdf-to-image" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>PDF to Image</h2>
        <p>Render PDF pages as images you can download.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select PDF</label>
        <input id="p2i-input" type="file" accept="application/pdf" />
      </div>
      <div class="flex flex-wrap gap-sm">
        <div class="field" style="flex:1 1 100px;max-width:150px;">
          <label>From page</label>
          <input id="p2i-from" type="number" min="1" placeholder="1" />
        </div>
        <div class="field" style="flex:1 1 100px;max-width:150px;">
          <label>To page</label>
          <input id="p2i-to" type="number" min="1" placeholder="leave blank for last" />
        </div>
        <div class="field" style="flex:1 1 120px;max-width:180px;">
          <label>Image type</label>
          <select id="p2i-type">
            <option value="png">PNG</option>
            <option value="jpeg">JPEG</option>
          </select>
        </div>
      </div>
      <button class="btn mt-sm" onclick="pdfToImages()">Convert</button>
      <div id="p2i-status" class="status"></div>
      <div id="p2i-gallery" class="section mt-md"></div>
    </div>
  </section>

  <!-- 9. Image Format Converter -->
  <section id="panel-image-format" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Image Format Converter</h2>
        <p>Convert between JPG, PNG and WEBP formats.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select image</label>
        <input id="fmt-input" type="file" accept="image/*" />
      </div>
      <div class="flex flex-wrap gap-sm">
        <div class="field" style="flex:1 1 120px;max-width:180px;">
          <label>Output format</label>
          <select id="fmt-output">
            <option value="image/jpeg">JPG</option>
            <option value="image/png">PNG</option>
            <option value="image/webp">WEBP</option>
          </select>
        </div>
        <div class="field" style="flex:1 1 120px;max-width:200px;">
          <label>Quality (JPG/WEBP)</label>
          <input id="fmt-quality" type="range" min="0.2" max="1" step="0.05" value="0.85" />
          <small><span id="fmt-quality-label">85</span>%</small>
        </div>
      </div>
      <button class="btn mt-sm" onclick="convertFormat()">Convert</button>
      <div id="fmt-status" class="status"></div>
      <a id="fmt-download" class="download-link" href="#" style="display:none;">⬇ Download converted image</a>
      <div class="divider"></div>
      <div class="section-title">Preview</div>
      <img id="fmt-preview" class="preview-img mt-xs" alt="" />
    </div>
  </section>

  <!-- 10. Photo Enhancer (AI-style) -->
  <section id="panel-photo-enhance" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>AI Photo Enhancer</h2>
        <p>
          Image quality improvement, noise reduction, color boost, upscaling,
          face enhancement, batch processing & old photo restoration — all in your browser.
        </p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>

    <div class="section">
      <div class="field">
        <label>Single image (for live preview)</label>
        <input id="enhance-input" type="file" accept="image/*" />
        <small>Select one image to preview all enhancements.</small>
      </div>

      <div class="field">
        <label>Batch images (optional)</label>
        <input id="enhance-batch-input" type="file" accept="image/*" multiple />
        <small>Batch processing: apply the same settings to multiple photos and auto-download results.</small>
      </div>

      <div class="flex flex-wrap gap-sm mt-xs">
        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Quality boost (overall)</label>
          <input id="enhance-quality" type="range" min="0" max="100" value="40" />
          <small><span id="enhance-quality-label">40</span> — sharpness, contrast & clarity</small>
        </div>

        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Noise reduction</label>
          <input id="enhance-noise" type="range" min="0" max="100" value="30" />
          <small><span id="enhance-noise-label">30</span> — clean low-light / grainy photos</small>
        </div>

        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Color enhancement</label>
          <input id="enhance-color" type="range" min="0" max="100" value="35" />
          <small><span id="enhance-color-label">35</span> — richer colors without oversaturation</small>
        </div>
      </div>

      <div class="flex flex-wrap gap-sm mt-xs">
        <div class="field" style="flex:1 1 150px;max-width:200px;">
          <label>Upscaling (resolution)</label>
          <select id="enhance-upscale">
            <option value="1">1× (no upscale)</option>
            <option value="1.5">1.5×</option>
            <option value="2">2×</option>
          </select>
          <small>Upscale small / low-res photos before enhancement.</small>
        </div>

        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>
            <input id="enhance-face" type="checkbox" checked />
            Face enhancement
          </label>
          <small>Extra clarity, contrast & color on the central face area.</small>
        </div>

        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>
            <input id="enhance-restore" type="checkbox" />
            Old photo restoration
          </label>
          <small>Fix faded photos: more contrast + cleaner whites.</small>
        </div>
      </div>

      <div class="flex flex-wrap gap-sm mt-xs">
        <button class="btn btn-outline" onclick="applyEnhanceSingle()">Apply to current image</button>
        <button class="btn btn-outline" onclick="autoEnhanceSmart()">AI-style auto enhance</button>
        <button class="btn" onclick="enhanceBatch()">Enhance batch images</button>
      </div>

      <div id="enhance-status" class="status mt-xs"></div>

      <a id="enhance-download" class="download-link" href="#" style="display:none;" download="enhanced.png">
        ⬇ Download enhanced image
      </a>

      <div class="hint mt-xs">
        • Image quality improvement = combination of clarity, sharpness & contrast.  
        • Noise reduction uses a smart blur + detail mix.  
        • Restoration mode is tuned for scanned / old / faded photos.
      </div>

      <div class="divider"></div>
      <div class="section-title">Preview</div>
      <div class="preview-row">
        <div style="flex:1;">
          <div class="pill-small">Original</div>
          <img id="enhance-original" class="preview-img mt-xs" alt="" />
          <div id="enhance-meta-original" class="hint mt-xs"></div>
        </div>
        <div style="flex:1;">
          <div class="pill-small">Enhanced</div>
          <canvas id="enhance-canvas" class="preview-img mt-xs"></canvas>
          <div id="enhance-meta-new" class="hint mt-xs"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- 12. Photo / PDF → Table → CSV (Photo to Excel lite) -->
  <section id="panel-photo-excel" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>Photo / PDF → Excel (Table OCR)</h2>
        <p>Marksheet, attendance, expense table photo/PDF থেকে data নিয়ে CSV বানাও (Excel open করবে).</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>

    <div class="section">
      <div class="field">
        <label>Select image or PDF (with table)</label>
        <input id="photoExcel-input" type="file" accept="image/*,application/pdf" />
        <small>Clear table photo/PDF ব্যবহার করলে best result পাবা.</small>
      </div>

      <div class="field">
        <label>Language</label>
        <select id="photoExcel-lang">
          <option value="eng">English (eng)</option>
          <option value="hin">Hindi (hin)</option>
          <option value="ben">Bengali (ben)</option>
        </select>
        <small>Hindi/Bengali এর জন্য প্রথমবার internet লাগতে পারে (Tesseract language data).</small>
      </div>

      <div class="field">
        <label>Column detection mode</label>
        <select id="photoExcel-split-mode">
          <option value="auto">Auto: 2+ space / tab / | দিয়ে column detect</option>
        </select>
        <small>Plain table হলেই কাজ করবে. এটা lite version – heavy complex table-এর জন্য perfect না.</small>
      </div>

      <button class="btn mt-sm" onclick="runPhotoExcel()">Run Table OCR & Build CSV</button>

      <div id="photoExcel-status" class="status mt-xs"></div>

      <div class="section mt-md">
        <div class="section-title">Raw OCR text (debug)</div>
        <textarea id="photoExcel-raw" placeholder="Here you can see raw OCR text, line by line."></textarea>
      </div>

      <div class="section mt-md">
        <div class="section-title">Preview CSV (Excel format)</div>
        <textarea id="photoExcel-csv" placeholder="Table → CSV preview here."></textarea>
        <a id="photoExcel-download" ...> class="download-link" href="#" style="display:none;" download="table.csv">
          ⬇ Download CSV (Open in Excel)
        </a>
        <div class="hint mt-xs">
          CSV file directly Excel / Google Sheets এ খুলে যাবে.
        </div>
      </div>
    </div>
  </section>

  <!-- 11. ID Photo Maker -->
  <section id="panel-id-photo" class="tool-panel">
    <div class="tool-header">
      <div>
        <h2>ID Photo Maker</h2>
        <p>Crop a portrait and generate passport-style ID photos with multiple copies.</p>
      </div>
      <button class="btn btn-outline" onclick="goHome()">← Back to tools</button>
    </div>
    <div class="section">
      <div class="field">
        <label>Select portrait photo</label>
        <input id="id-input" type="file" accept="image/*" />
      </div>
      <div class="flex flex-wrap gap-sm mt-xs">
        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Preset size (single ID)</label>
          <select id="id-preset">
            <option value="295x413">Passport (~35×49 mm → 295×413 px)</option>
            <option value="600x600">2×2 inch (~300 DPI → 600×600 px)</option>
            <option value="413x531">Visa (~413×531 px)</option>
          </select>
        </div>
        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Background color</label>
          <select id="id-bg">
            <option value="#ffffff">White</option>
            <option value="#1d4ed8">Blue</option>
            <option value="#dc2626">Red</option>
            <option value="#f1f5f9">Off-white</option>
          </select>
        </div>
      </div>
      <div class="flex flex-wrap gap-sm mt-xs">
        <div class="field" style="flex:1 1 150px;max-width:220px;">
          <label>Copies layout</label>
          <div class="flex gap-xs">
            <input id="id-cols" type="number" min="1" max="5" value="3" style="max-width:60px;" />
            <span style="align-self:center;font-size:0.78rem;">per row</span>
            <input id="id-rows" type="number" min="1" max="6" value="4" style="max-width:60px;margin-left:0.4rem;" />
            <span style="align-self:center;font-size:0.78rem;">rows</span>
          </div>
          <small>Sheet will contain cols × rows ID copies.</small>
        </div>
      </div>
      <div id="id-crop-container" class="id-crop-wrapper mt-sm" style="display:none;">
        <img id="id-img" class="id-crop-img" alt="" />
        <div id="id-crop-rect" class="crop-rect"></div>
      </div>
      <button class="btn mt-sm" onclick="generateIdPhoto()">Generate ID Photo Sheet</button>
      <div id="id-status" class="status"></div>
      <a id="id-download" class="download-link" href="#" style="display:none;" download="id-photos.png">⬇ Download ID photos sheet</a>
    </div>
  </section>
 
 <!-- Trust & E-E-A-T section -->
  <section class="trust-section" aria-label="Why Adhurjya Store is safe and trusted">
    <div class="trust-title">Why people can trust Adhurjya Store</div>
    <div class="trust-sub">
      All tools run directly in your browser tab — no file upload to any server.
      Perfect for marksheets, ID photos, office PDFs and day-to-day work.
    </div>

    <div class="trust-grid">
      <div class="trust-card">
        <strong>100% client-side processing</strong>
        Photos &amp; PDFs are handled locally in your device’s memory using JavaScript.
        We don’t see, store or log your documents — once you close the tab, everything is gone.
      </div>

      <div class="trust-card">
        <strong>Built for real-life documents</strong>
        Photo → PDF, table OCR, ID photo maker, compressor — সব গুলোই
        practical কাজের জন্য বানানো: exams, forms, office use, online apply ইত্যাদি।
        আমরা আস্তে আস্তে সব টুল আরও stable করছি।
      </div>

      <div class="trust-card">
        <strong>No login, no signup, no hidden paywall</strong>
        You can start using tools instantly. Future “Pro” features clearly আলাদা করে দেখানো হবে,
        যাতে free আর paid কখনও mix না হয় — no surprise charges.
      </div>
    </div>

    <div class="trust-footer">
      Adhurjya Store is an independent browser-tools project from India.
      We regularly test tools on mobile &amp; low-end laptops so that students, job-seekers and office users
      can use them safely without heavy apps.
    </div>
  </section>

</main>

<script>
  // ---------- GLOBAL HELPERS ----------
  const { PDFDocument } = PDFLib;
  pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";

  function openTool(slug){
    document.getElementById('home-section').style.display='none';
    document.querySelectorAll('.tool-panel').forEach(p=>p.style.display='none');
    const panel=document.getElementById('panel-'+slug);
    if(panel){panel.style.display='block';window.scrollTo({top:0,behavior:'smooth'});}
  }
  function goHome(){
    document.querySelectorAll('.tool-panel').forEach(p=>p.style.display='none');
    document.getElementById('home-section').style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
  }

  function bytesToKB(bytes){
    return (bytes/1024).toFixed(1);
  }
  function dataURLToUint8Array(dataURL){
    const base64 = dataURL.split(',')[1];
    const raw = atob(base64);
    const arr = new Uint8Array(raw.length);
    for(let i=0;i<raw.length;i++)arr[i]=raw.charCodeAt(i);
    return arr;
  }
  function blobFromDataURL(dataURL){
    const arr = dataURLToUint8Array(dataURL);
    const mime = dataURL.substring(dataURL.indexOf(':')+1,dataURL.indexOf(';'));
    return new Blob([arr],{type:mime});
  }
  function downloadBlob(blob,filename){
    const url = URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;a.download=filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url),2000);
  }
  function readFileAsDataURL(file){
    return new Promise((resolve,reject)=>{
      const fr=new FileReader();
      fr.onload=()=>resolve(fr.result);
      fr.onerror=reject;
      fr.readAsDataURL(file);
    });
  }
  function loadImageFromDataURL(dataURL){
    return new Promise((resolve,reject)=>{
      const img=new Image();
      img.onload=()=>resolve(img);
      img.onerror=reject;
      img.src=dataURL;
    });
  }
  async function loadImageFromFile(file){
    const url = await readFileAsDataURL(file);
    return loadImageFromDataURL(url);
  }

  // ---------- 1. PHOTO → PDF ----------
  let photoPdfFiles = [];

  document.getElementById('photoPdf-input').addEventListener('change', (e)=>{
    const files = Array.from(e.target.files || []);
    if(!files.length)return;
    photoPdfFiles = photoPdfFiles.concat(files);
    renderPhotoPdfList();
  });

  function renderPhotoPdfList(){
    const listEl=document.getElementById('photoPdf-list');
    listEl.innerHTML='';
    if(!photoPdfFiles.length){
      listEl.innerHTML='<div class="hint">No images selected yet.</div>';
      return;
    }
    photoPdfFiles.forEach((file,idx)=>{
      const item=document.createElement('div');
      item.className='thumb-item';
      const imgEl=document.createElement('img');
      const meta=document.createElement('div');
      meta.className='thumb-meta';
      const nameDiv=document.createElement('div');
      nameDiv.textContent=file.name;
      const small=document.createElement('small');
      small.textContent=bytesToKB(file.size)+' KB';
      meta.appendChild(nameDiv);meta.appendChild(small);
      const actions=document.createElement('div');
      actions.className='thumb-actions';
      const up=document.createElement('button');
      up.className='icon-btn';up.textContent='↑';
      up.disabled = idx===0;
      up.onclick=()=>{swapInArray(photoPdfFiles,idx,idx-1);renderPhotoPdfList();};
      const down=document.createElement('button');
      down.className='icon-btn';down.textContent='↓';
      down.disabled = idx===photoPdfFiles.length-1;
      down.onclick=()=>{swapInArray(photoPdfFiles,idx,idx+1);renderPhotoPdfList();};
      const del=document.createElement('button');
      del.className='icon-btn';del.textContent='✕';
      del.onclick=()=>{photoPdfFiles.splice(idx,1);renderPhotoPdfList();};
      actions.appendChild(up);actions.appendChild(down);actions.appendChild(del);
      item.appendChild(imgEl);item.appendChild(meta);item.appendChild(actions);
      listEl.appendChild(item);
      readFileAsDataURL(file).then(url=>{imgEl.src=url;}).catch(()=>{});
    });
  }
  function swapInArray(arr,i,j){
    const t=arr[i];arr[i]=arr[j];arr[j]=t;
  }

  async function generatePhotoPdf(){
    const status=document.getElementById('photoPdf-status');
    const link=document.getElementById('photoPdf-download');
    link.style.display='none';link.href='#';
    status.textContent='';
    if(!photoPdfFiles.length){
      status.textContent='Please select at least one image.';
      status.className='status error';
      return;
    }
    const maxDim = parseInt(document.getElementById('photoPdf-maxDim').value)||1600;
    const quality = parseFloat(document.getElementById('photoPdf-quality').value)||0.7;
    try{
      status.textContent='Processing images and building PDF...';
      status.className='status';
      const pdfDoc = await PDFDocument.create();
      for(let idx=0;idx<photoPdfFiles.length;idx++){
        const file = photoPdfFiles[idx];
        status.textContent=`Processing image ${idx+1} of ${photoPdfFiles.length}...`;
        const img = await loadImageFromFile(file);
        const ratio = Math.min(1,maxDim/Math.max(img.width,img.height));
        const w = Math.round(img.width*ratio);
        const h = Math.round(img.height*ratio);
        const canvas=document.createElement('canvas');
        canvas.width=w;canvas.height=h;
        const ctx=canvas.getContext('2d');
        ctx.drawImage(img,0,0,w,h);
        const dataURL = canvas.toDataURL('image/jpeg',quality);
        const bytes = dataURLToUint8Array(dataURL);
        const embedded = await pdfDoc.embedJpg(bytes);
        const page = pdfDoc.addPage([embedded.width,embedded.height]);
        page.drawImage(embedded,{x:0,y:0,width:embedded.width,height:embedded.height});
      }
      status.textContent='Finalizing PDF...';
      const pdfBytes = await pdfDoc.save();
      const blob = new Blob([pdfBytes],{type:'application/pdf'});
      const url = URL.createObjectURL(blob);
      link.href=url;
      link.style.display='inline-flex';
      link.onclick=()=>{setTimeout(()=>URL.revokeObjectURL(url),2000);};
      status.textContent=`Done. Estimated size: ${bytesToKB(blob.size)} KB`;
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Something went wrong while generating the PDF.';
      status.className='status error';
    }
  }

  // ---------- 2. PHOTO COMPRESSOR ----------
  let compressOriginalUrl=null;
  document.getElementById('compress-quality').addEventListener('input',(e)=>{
    document.getElementById('compress-quality-label').textContent = Math.round(parseFloat(e.target.value)*100);
  });
  document.getElementById('compress-input').addEventListener('change', async (e)=>{
    const file = e.target.files[0];
    const originalSizeEl=document.getElementById('compress-original-size');
    const preview=document.getElementById('compress-original-preview');
    if(!file){originalSizeEl.textContent='–';preview.src='';return;}
    originalSizeEl.textContent=bytesToKB(file.size);
    compressOriginalUrl = await readFileAsDataURL(file);
    preview.src = compressOriginalUrl;
  });

  async function compressPhoto(){
    const input=document.getElementById('compress-input');
    const file=input.files[0];
    const statusOriginal=document.getElementById('compress-original-size');
    const statusNew=document.getElementById('compress-new-size');
    const previewNew=document.getElementById('compress-new-preview');
    const link=document.getElementById('compress-download');
    link.style.display='none';link.href='#';
    statusNew.textContent='–';
    if(!file){
      alert('Please select an image first.');
      return;
    }
    try{
      const quality = parseFloat(document.getElementById('compress-quality').value)||0.7;
      const maxW = parseInt(document.getElementById('compress-maxW').value)||null;
      const maxH = parseInt(document.getElementById('compress-maxH').value)||null;
      const img = await loadImageFromFile(file);
      let w=img.width,h=img.height;
      if(maxW || maxH){
        const ratio = Math.min(
          maxW ? maxW/w : 1,
          maxH ? maxH/h : 1
        );
        if(ratio<1){w=Math.round(w*ratio);h=Math.round(h*ratio);}
      }
      const canvas=document.createElement('canvas');
      canvas.width=w;canvas.height=h;
      const ctx=canvas.getContext('2d');
      ctx.drawImage(img,0,0,w,h);
      const dataURL = canvas.toDataURL('image/jpeg',quality);
      const blob = blobFromDataURL(dataURL);
      const url=URL.createObjectURL(blob);
      previewNew.src=url;
      statusOriginal.textContent=bytesToKB(file.size);
      statusNew.textContent=bytesToKB(blob.size);
      link.href=url;
      link.download='compressed.jpg';
      link.style.display='inline-flex';
    }catch(err){
      console.error(err);
      alert('Compression failed.');
    }
  }

  // ---------- 3. IMAGE RESIZER ----------
  let resizeImageFile=null;
  document.getElementById('resize-input').addEventListener('change', async (e)=>{
    const file=e.target.files[0];
    const wEl=document.getElementById('resize-width');
    const hEl=document.getElementById('resize-height');
    const originalPrev=document.getElementById('resize-original-preview');
    const status=document.getElementById('resize-status');
    document.getElementById('resize-download').style.display='none';
    document.getElementById('resize-new-preview').src='';
    if(!file){originalPrev.src='';status.textContent='';return;}
    try{
      const dataURL=await readFileAsDataURL(file);
      resizeImageFile=file;
      const img=await loadImageFromDataURL(dataURL);
      originalPrev.src=dataURL;
      wEl.value=img.width;
      hEl.value=img.height;
      status.textContent=`Original: ${img.width}×${img.height}`;
      status.className='status';
    }catch(err){
      console.error(err);
      status.textContent='Could not load image.';
      status.className='status error';
    }
  });

  document.getElementById('resize-width').addEventListener('input',()=>{
    syncResizeAspect(true);
  });
  document.getElementById('resize-height').addEventListener('input',()=>{
    syncResizeAspect(false);
  });

  async function syncResizeAspect(widthChanged){
    if(!resizeImageFile) return;
    const keep=document.getElementById('resize-keep-aspect').checked;
    if(!keep)return;
    const wEl=document.getElementById('resize-width');
    const hEl=document.getElementById('resize-height');
    const dataURL=await readFileAsDataURL(resizeImageFile);
    const img=await loadImageFromDataURL(dataURL);
    const aspect = img.width/img.height;
    if(widthChanged){
      const w=parseInt(wEl.value)||img.width;
      hEl.value=Math.round(w/aspect);
    }else{
      const h=parseInt(hEl.value)||img.height;
      wEl.value=Math.round(h*aspect);
    }
  }

  async function resizeImage(){
    const file=resizeImageFile;
    const w=parseInt(document.getElementById('resize-width').value);
    const h=parseInt(document.getElementById('resize-height').value);
    const status=document.getElementById('resize-status');
    const link=document.getElementById('resize-download');
    const newPrev=document.getElementById('resize-new-preview');
    link.style.display='none';newPrev.src='';
    if(!file){status.textContent='Please select an image first.';status.className='status error';return;}
    if(!w || !h){status.textContent='Please enter valid width and height.';status.className='status error';return;}
    try{
      const img=await loadImageFromFile(file);
      const canvas=document.createElement('canvas');
      canvas.width=w;canvas.height=h;
      const ctx=canvas.getContext('2d');
      ctx.imageSmoothingEnabled=true;
      ctx.imageSmoothingQuality='high';
      ctx.drawImage(img,0,0,w,h);
      const dataURL=canvas.toDataURL('image/png');
      const blob=blobFromDataURL(dataURL);
      const url=URL.createObjectURL(blob);
      newPrev.src=url;
      link.href=url;
      link.download='resized.png';
      link.style.display='inline-flex';
      status.textContent=`Resized to ${w}×${h}`;
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Resizing failed.';
      status.className='status error';
    }
  }

  // ---------- 5. OCR (IMAGE + PDF, PRE-PROCESSED) ----------
  async function runOcr(){
    const input=document.getElementById('ocr-input');
    const file=input.files[0];
    const lang=document.getElementById('ocr-lang').value;
    const status=document.getElementById('ocr-status');
    const out=document.getElementById('ocr-output');
    const bar=document.getElementById('ocr-progress-bar');
    const inner=document.getElementById('ocr-progress-inner');
    out.value='';
    inner.style.width='0%';
    bar.style.display='none';
    if(!file){
      status.textContent='Please select an image or PDF first.';
      status.className='status error';
      return;
    }
    status.textContent='Loading OCR engine and preparing input...';
    status.className='status';
    const T = window.Tesseract;
    try{
      bar.style.display='block';
      if(file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')){
        // PDF OCR
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({data:arrayBuffer}).promise;
        const totalPages = pdf.numPages;
        let allText = [];
        for(let pageNum=1; pageNum<=totalPages; pageNum++){
          const page = await pdf.getPage(pageNum);
          const viewport = page.getViewport({scale:2}); // higher DPI for better OCR
          const canvas=document.createElement('canvas');
          const ctx=canvas.getContext('2d');
          canvas.width=viewport.width;
          canvas.height=viewport.height;
          await page.render({canvasContext:ctx,viewport}).promise;

          status.textContent=`Running OCR on page ${pageNum} of ${totalPages}...`;
          const result = await T.recognize(canvas, lang, {
            logger:m=>{
              if(m.status==='recognizing text' && m.progress){
                const global = ((pageNum-1) + m.progress)/totalPages*100;
                inner.style.width = global.toFixed(0)+'%';
              }
            }
          });
          allText.push(`--- Page ${pageNum} ---\n`+(result.data.text || '').trim());
        }
        out.value = allText.join('\n\n');
        status.textContent='OCR finished for all pages. Review and edit if needed.';
        status.className='status success';
      }else{
        // IMAGE OCR with pre-processing
        const dataURL = await readFileAsDataURL(file);
        const img = await loadImageFromDataURL(dataURL);

        // Preprocess: upscale to at least 1500px on longer side, grayscale, contrast
        const maxDim = 1800;
        const needScale = maxDim / Math.max(img.width, img.height);
        const scale = needScale < 1 ? needScale : 1;
        const w = Math.round(img.width * scale);
        const h = Math.round(img.height * scale);

        const canvas=document.createElement('canvas');
        const ctx=canvas.getContext('2d');
        canvas.width=w;canvas.height=h;
        ctx.drawImage(img,0,0,w,h);

        let imgData = ctx.getImageData(0,0,w,h);
        let d = imgData.data;
        const c = 1.2; // mild contrast boost
        const intercept = 128*(1-c);
        for(let i=0;i<d.length;i+=4){
          let r=d[i], g=d[i+1], b=d[i+2];
          let grey = 0.299*r+0.587*g+0.114*b;
          grey = c*grey + intercept + 5; // little brighten
          grey = Math.max(0,Math.min(255,grey));
          d[i]=d[i+1]=d[i+2]=grey;
        }
        ctx.putImageData(imgData,0,0);

        status.textContent='Running OCR on image...';
        const result = await T.recognize(canvas, lang, {
          logger:m=>{
            if(m.status==='recognizing text' && m.progress){
              inner.style.width = (m.progress*100).toFixed(0)+'%';
            }
          }
        });
        out.value = result.data.text || '';
        status.textContent='OCR finished. Check and edit if needed.';
        status.className='status success';
      }
    }catch(err){
      console.error(err);
      status.textContent='OCR failed. Try a clearer scan, or check that language data is available.';
      status.className='status error';
      bar.style.display='none';
    }
  }

  async function copyOcrText(){
    const txt=document.getElementById('ocr-output').value;
    if(!txt){alert('No text to copy.');return;}
    try{
      await navigator.clipboard.writeText(txt);
      alert('Copied to clipboard.');
    }catch{
      alert('Could not copy automatically. Please select and copy manually.');
    }
  }

  // ---------- 6. PDF COMPRESSOR ----------
  async function compressPdf(){
    const input=document.getElementById('pdfc-input');
    const file=input.files[0];
    const status=document.getElementById('pdfc-status');
    const link=document.getElementById('pdfc-download');
    link.style.display='none';link.href='#';
    if(!file){
      status.textContent='Please select a PDF file.';
      status.className='status error';
      return;
    }
    status.textContent='Loading PDF...';
    status.className='status';
    try{
      const preset=document.getElementById('pdfc-quality').value;
      let scale=1,quality=0.8;
      if(preset==='high'){scale=1;quality=0.9;}
      else if(preset==='medium'){scale=0.9;quality=0.75;}
      else{scale=0.8;quality=0.6;}
      const arrayBuffer=await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument({data:arrayBuffer}).promise;
      const pageCount=pdf.numPages;
      status.textContent=`Rendering ${pageCount} page(s)... this may take a while.`;
      const newDoc = await PDFDocument.create();
      for(let i=1;i<=pageCount;i++){
        status.textContent=`Rendering page ${i} of ${pageCount}...`;
        const page = await pdf.getPage(i);
        const viewport = page.getViewport({scale:scale});
        const canvas=document.createElement('canvas');
        const ctx=canvas.getContext('2d');
        canvas.width=viewport.width;
        canvas.height=viewport.height;
        await page.render({canvasContext:ctx,viewport}).promise;
        const dataURL=canvas.toDataURL('image/jpeg',quality);
        const bytes=dataURLToUint8Array(dataURL);
        const embedded=await newDoc.embedJpg(bytes);
        const p=newDoc.addPage([embedded.width,embedded.height]);
        p.drawImage(embedded,{x:0,y:0,width:embedded.width,height:embedded.height});
      }
      status.textContent='Building compressed PDF...';
      const newBytes=await newDoc.save();
      const blob=new Blob([newBytes],{type:'application/pdf'});
      const url=URL.createObjectURL(blob);
      link.href=url;
      link.style.display='inline-flex';
      link.onclick=()=>{setTimeout(()=>URL.revokeObjectURL(url),2000);};
      status.textContent=`Done. Original: ${bytesToKB(file.size)} KB • Compressed: ${bytesToKB(blob.size)} KB`;
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Compression failed. PDF may be too complex or large for browser processing.';
      status.className='status error';
    }
  }

  // ---------- 7. MERGE PDF ----------
  let mergePdfsFiles=[];
  document.getElementById('merge-input').addEventListener('change',(e)=>{
    const files=Array.from(e.target.files||[]);
    mergePdfsFiles = mergePdfsFiles.concat(files);
    renderMergeList();
  });
  function renderMergeList(){
    const list=document.getElementById('merge-list');
    list.innerHTML='';
    if(!mergePdfsFiles.length){
      list.innerHTML='<div class="hint">No PDFs selected yet.</div>';
      return;
    }
    mergePdfsFiles.forEach((file,idx)=>{
      const item=document.createElement('div');
      item.className='thumb-item';
      const icon=document.createElement('div');
      icon.className='pill-small';
      icon.textContent='PDF';
      const meta=document.createElement('div');
      meta.className='thumb-meta';
      const name=document.createElement('div');
      name.textContent=file.name;
      const size=document.createElement('small');
      size.textContent=bytesToKB(file.size)+' KB';
      meta.appendChild(name);meta.appendChild(size);
      const actions=document.createElement('div');
      actions.className='thumb-actions';
      const up=document.createElement('button');
      up.className='icon-btn';up.textContent='↑';up.disabled=idx===0;
      up.onclick=()=>{swapInArray(mergePdfsFiles,idx,idx-1);renderMergeList();};
      const down=document.createElement('button');
      down.className='icon-btn';down.textContent='↓';down.disabled=idx===mergePdfsFiles.length-1;
      down.onclick=()=>{swapInArray(mergePdfsFiles,idx,idx+1);renderMergeList();};
      const del=document.createElement('button');
      del.className='icon-btn';del.textContent='✕';
      del.onclick=()=>{mergePdfsFiles.splice(idx,1);renderMergeList();};
      actions.appendChild(up);actions.appendChild(down);actions.appendChild(del);
      item.appendChild(icon);item.appendChild(meta);item.appendChild(actions);
      list.appendChild(item);
    });
  }

  async function mergePdfs(){
    const status=document.getElementById('merge-status');
    const link=document.getElementById('merge-download');
    link.style.display='none';link.href='#';
    if(!mergePdfsFiles.length){
      status.textContent='Please add at least two PDFs.';
      status.className='status error';
      return;
    }
    try{
      status.textContent='Merging PDFs...';
      status.className='status';
      const merged = await PDFDocument.create();
      for(let i=0;i<mergePdfsFiles.length;i++){
        status.textContent=`Merging file ${i+1} of ${mergePdfsFiles.length}...`;
        const file=mergePdfsFiles[i];
        const bytes = new Uint8Array(await file.arrayBuffer());
        const srcDoc = await PDFDocument.load(bytes);
        const indices = srcDoc.getPageIndices();
        const pages = await merged.copyPages(srcDoc,indices);
        pages.forEach(p=>merged.addPage(p));
      }
      const outBytes=await merged.save();
      const blob=new Blob([outBytes],{type:'application/pdf'});
      const url=URL.createObjectURL(blob);
      link.href=url;
      link.style.display='inline-flex';
      link.onclick=()=>{setTimeout(()=>URL.revokeObjectURL(url),2000);};
      status.textContent=`Done. Pages merged: ${mergePdfsFiles.length} file(s).`;
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Merge failed. Check PDF files and try again.';
      status.className='status error';
    }
  }

  // ---------- 8. PDF TO IMAGE ----------
  async function pdfToImages(){
    const input=document.getElementById('p2i-input');
    const file=input.files[0];
    const fromEl=document.getElementById('p2i-from');
    const toEl=document.getElementById('p2i-to');
    const type=document.getElementById('p2i-type').value;
    const status=document.getElementById('p2i-status');
    const gallery=document.getElementById('p2i-gallery');
    gallery.innerHTML='';
    if(!file){
      status.textContent='Please select a PDF.';
      status.className='status error';
      return;
    }
    try{
      const arrayBuffer=await file.arrayBuffer();
      const pdf=await pdfjsLib.getDocument({data:arrayBuffer}).promise;
      const total=pdf.numPages;
      let from=parseInt(fromEl.value)||1;
      let to=parseInt(toEl.value)||total;
      from=Math.max(1,Math.min(from,total));
      to=Math.max(from,Math.min(to,total));
      status.textContent=`Rendering pages ${from} to ${to}...`;
      status.className='status';
      for(let pageNum=from;pageNum<=to;pageNum++){
        const page=await pdf.getPage(pageNum);
        const viewport=page.getViewport({scale:1});
        const canvas=document.createElement('canvas');
        const ctx=canvas.getContext('2d');
        canvas.width=viewport.width;
        canvas.height=viewport.height;
        await page.render({canvasContext:ctx,viewport}).promise;
        const dataURL=canvas.toDataURL('image/'+type,0.9);
        const blob=blobFromDataURL(dataURL);
        const url=URL.createObjectURL(blob);

        const card=document.createElement('div');
        card.className='section';
        const title=document.createElement('div');
        title.className='section-title';
        title.textContent='Page '+pageNum;
        const img=document.createElement('img');
        img.src=url;
        img.className='preview-img mt-xs';
        const a=document.createElement('a');
        a.className='download-link';
        a.href=url;
        a.download=`page-${pageNum}.${type==='png'?'png':'jpg'}`;
        a.textContent='⬇ Download image';
        card.appendChild(title);
        card.appendChild(img);
        card.appendChild(a);
        gallery.appendChild(card);
      }
      status.textContent='Pages rendered. Scroll down to download images.';
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Conversion failed. PDF may be too heavy for this device.';
      status.className='status error';
    }
  }

  // ---------- 9. IMAGE FORMAT CONVERTER ----------
  document.getElementById('fmt-quality').addEventListener('input',(e)=>{
    document.getElementById('fmt-quality-label').textContent=Math.round(parseFloat(e.target.value)*100);
  });

  let fmtImageFile=null;
  document.getElementById('fmt-input').addEventListener('change', async (e)=>{
    const file=e.target.files[0];
    const preview=document.getElementById('fmt-preview');
    const status=document.getElementById('fmt-status');
    document.getElementById('fmt-download').style.display='none';
    if(!file){preview.src='';status.textContent='';return;}
    fmtImageFile=file;
    preview.src=await readFileAsDataURL(file);
    status.textContent=`Selected: ${file.name} (${bytesToKB(file.size)} KB)`;
    status.className='status';
  });

  async function convertFormat(){
    const file=fmtImageFile;
    const outFmt=document.getElementById('fmt-output').value;
    const q=parseFloat(document.getElementById('fmt-quality').value)||0.85;
    const status=document.getElementById('fmt-status');
    const preview=document.getElementById('fmt-preview');
    const link=document.getElementById('fmt-download');
    link.style.display='none';
    if(!file){
      status.textContent='Please select an image first.';
      status.className='status error';
      return;
    }
    try{
      status.textContent='Converting...';
      status.className='status';
      const img=await loadImageFromFile(file);
      const canvas=document.createElement('canvas');
      canvas.width=img.width;
      canvas.height=img.height;
      const ctx=canvas.getContext('2d');
      ctx.drawImage(img,0,0);
      const mime=outFmt;
      const needQuality = (mime==='image/jpeg' || mime==='image/webp');
      const dataURL=canvas.toDataURL(mime,needQuality?q:undefined);
      const blob=blobFromDataURL(dataURL);
      const url=URL.createObjectURL(blob);
      preview.src=url;
      let ext='png';
      if(mime==='image/jpeg')ext='jpg';
      else if(mime==='image/webp')ext='webp';
      link.href=url;
      link.download=`converted.${ext}`;
      link.style.display='inline-flex';
      status.textContent=`Converted size: ${bytesToKB(blob.size)} KB`;
      status.className='status success';
    }catch(err){
      console.error(err);
      status.textContent='Conversion failed (format may not be supported on this browser).';
      status.className='status error';
    }
  }
      // ---------- 10. PHOTO ENHANCER (ADVANCED AI-STYLE, MOBILE SAFE) ----------
  let enhanceImg = null;
  let enhanceOriginalURL = null;
  const enhanceCanvas = document.getElementById('enhance-canvas');
  const enhanceCtx = enhanceCanvas.getContext('2d');

  const enhanceStatus = document.getElementById('enhance-status');
  const enhanceDownloadLink = document.getElementById('enhance-download');
  const enhanceOriginalImg = document.getElementById('enhance-original');
  const metaOriginal = document.getElementById('enhance-meta-original');
  const metaNew = document.getElementById('enhance-meta-new');

  // Mobile detect → বড় image limit করে দেবো
  const isMobile =
    /Android|webOS|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(navigator.userAgent) ||
    window.innerWidth < 768;
  const MAX_ENHANCE_DIM = isMobile ? 1400 : 2200; // longer side cap (px)

  // slider label updates
  document.getElementById('enhance-quality').addEventListener('input',(e)=>{
    document.getElementById('enhance-quality-label').textContent = e.target.value;
  });
  document.getElementById('enhance-noise').addEventListener('input',(e)=>{
    document.getElementById('enhance-noise-label').textContent = e.target.value;
  });
  document.getElementById('enhance-color').addEventListener('input',(e)=>{
    document.getElementById('enhance-color-label').textContent = e.target.value;
  });

  // single image load
  document.getElementById('enhance-input').addEventListener('change', async (e)=>{
    const file = e.target.files[0];
    enhanceDownloadLink.style.display = 'none';
    metaNew.textContent = '';
    if(!file){
      enhanceImg = null;
      enhanceOriginalURL = null;
      enhanceOriginalImg.src = '';
      enhanceCanvas.width = enhanceCanvas.height = 0;
      enhanceStatus.textContent = '';
      return;
    }
    const url = await readFileAsDataURL(file);
    enhanceOriginalURL = url;
    enhanceImg = await loadImageFromDataURL(url);
    enhanceOriginalImg.src = url;

    // শুধু initial preview, real processing will use capped size
    enhanceCanvas.width = enhanceImg.width;
    enhanceCanvas.height = enhanceImg.height;
    enhanceCtx.drawImage(enhanceImg,0,0);

    metaOriginal.textContent = `Original: ${enhanceImg.width}×${enhanceImg.height}px`;
    enhanceStatus.textContent = 'Image loaded. Adjust sliders and click “Apply to current image”.';
    enhanceStatus.className = 'status';
  });

  function getEnhanceOptions(){
    return {
      quality: parseInt(document.getElementById('enhance-quality').value) || 0,
      noise: parseInt(document.getElementById('enhance-noise').value)   || 0,
      color: parseInt(document.getElementById('enhance-color').value)   || 0,
      upscale: parseFloat(document.getElementById('enhance-upscale').value) || 1,
      faceEnhance: document.getElementById('enhance-face').checked,
      restore: document.getElementById('enhance-restore').checked
    };
  }

  // 3×3 blur helper for noise reduction
  function blurImageData(src, w, h){
    const out = new Uint8ClampedArray(src.length);
    const idx = (x,y)=> (y*w+x)*4;
    for(let y=0;y<h;y++){
      for(let x=0;x<w;x++){
        let r=0,g=0,b=0,a=0,count=0;
        for(let ky=-1;ky<=1;ky++){
          for(let kx=-1;kx<=1;kx++){
            const nx=x+kx, ny=y+ky;
            if(nx<0||ny<0||nx>=w||ny>=h) continue;
            const i4 = idx(nx,ny);
            r+=src[i4]; g+=src[i4+1]; b+=src[i4+2]; a+=src[i4+3];
            count++;
          }
        }
        const o4 = idx(x,y);
        out[o4]   = r/count;
        out[o4+1] = g/count;
        out[o4+2] = b/count;
        out[o4+3] = a/count;
      }
    }
    return out;
  }

  // main enhancement pipeline on an HTMLImageElement (OPTIMIZED)
  async function runEnhancementOnImage(img, opts){
    const {quality, noise, color, upscale, faceEnhance, restore} = opts;

    // ১) Upscale + size cap একসাথে
    const userScale = Math.max(1, upscale || 1);
    let w = img.width * userScale;
    let h = img.height * userScale;

    const longSide = Math.max(w, h);
    if(longSide > MAX_ENHANCE_DIM){
      const s = MAX_ENHANCE_DIM / longSide;
      w = Math.round(w * s);
      h = Math.round(h * s);
    }

    w = Math.max(1, Math.round(w));
    h = Math.max(1, Math.round(h));

    enhanceCanvas.width = w;
    enhanceCanvas.height = h;
    enhanceCtx.imageSmoothingEnabled = true;
    enhanceCtx.imageSmoothingQuality = 'high';
    enhanceCtx.drawImage(img, 0, 0, w, h);

    let imgData = enhanceCtx.getImageData(0,0,w,h);
    const data = imgData.data;
    const original = new Uint8ClampedArray(data); // keep copy for noise/restore

    const qFactor = (quality||0)/100;
    const colorFactor = (color||0)/100;
    const noiseStrength = Math.min(0.7, (noise||0)/100);

    // noise slider কম থাকলে blur skip → fast
    let blurred = null;
    if(noiseStrength > 0.18){
      blurred = blurImageData(original, w, h);
    }

    // face area ellipse (soft region)
    const faceCX = w / 2;
    const faceCY = h * 0.45;
    const faceRX = w * 0.3;
    const faceRY = h * 0.45;

    for(let y=0;y<h;y++){
      for(let x=0;x<w;x++){
        const i = (y*w + x)*4;
        let r = original[i];
        let g = original[i+1];
        let b = original[i+2];
        const a = original[i+3];

        // noise reduction: mix with blurred copy
        if(blurred){
          r = r*(1-noiseStrength) + blurred[i]*noiseStrength;
          g = g*(1-noiseStrength) + blurred[i+1]*noiseStrength;
          b = b*(1-noiseStrength) + blurred[i+2]*noiseStrength;
        }

        // base quality: brightness + contrast
        const bright = 10*qFactor;
        const contrast = 1 + 0.4*qFactor;
        r = r*contrast + bright;
        g = g*contrast + bright;
        b = b*contrast + bright;

        // color enhancement (saturation)
        const grey = 0.299*r+0.587*g+0.114*b;
        const satBoost = 1 + 0.8*colorFactor;
        r = grey + (r-grey)*satBoost;
        g = grey + (g-grey)*satBoost;
        b = grey + (b-grey)*satBoost;

        // old-photo restoration
        if(restore){
          const restoreC = 1.1;
          r = (r-128)*restoreC + 128;
          g = (g-128)*restoreC + 128;
          b = (b-128)*restoreC + 128;

          const avg = (r+g+b)/3;
          const warm = (r+g)/2;
          const cast = warm - avg;
          r -= cast*0.3;
          g -= cast*0.2;
        }

        // face enhancement (soft boost near center)
        if(faceEnhance){
          const dx = (x - faceCX)/faceRX;
          const dy = (y - faceCY)/faceRY;
          const dist = dx*dx + dy*dy;
          if(dist < 1){
            const t = 1 - dist;               // center = 1, edge = 0
            const feC = 1 + 0.25*t*qFactor;   // extra contrast
            const feB = 5*t*qFactor;         // extra brightness
            r = (r-128)*feC + 128 + feB;
            g = (g-128)*feC + 128 + feB;
            b = (b-128)*feC + 128 + feB;
          }
        }

        data[i]   = Math.max(0,Math.min(255,r));
        data[i+1] = Math.max(0,Math.min(255,g));
        data[i+2] = Math.max(0,Math.min(255,b));
        data[i+3] = a;
      }
    }

    // sharpening শুধু quality বেশি হলে
    if(qFactor > 0.25){
      const amount = qFactor*0.6;
      const src = new Uint8ClampedArray(data);
      const idx = (x,y)=>(y*w+x)*4;
      const k = [0,-1,0,-1,5,-1,0,-1,0];

      for(let y=1;y<h-1;y++){
        for(let x=1;x<w-1;x++){
          let rr=0,gg=0,bb=0,ki=0;
          for(let ky=-1;ky<=1;ky++){
            for(let kx=-1;kx<=1;kx++){
              const i4 = idx(x+kx,y+ky);
              const wght = k[ki++];
              rr += src[i4]*wght;
              gg += src[i4+1]*wght;
              bb += src[i4+2]*wght;
            }
          }
          const i4 = idx(x,y);
          data[i4]   = data[i4]*(1-amount)   + rr*amount;
          data[i4+1] = data[i4+1]*(1-amount) + gg*amount;
          data[i4+2] = data[i4+2]*(1-amount) + bb*amount;
        }
      }
      // clamp again
      for(let i=0;i<data.length;i+=4){
        data[i]   = Math.max(0,Math.min(255,data[i]));
        data[i+1] = Math.max(0,Math.min(255,data[i+1]));
        data[i+2] = Math.max(0,Math.min(255,data[i+2]));
      }
    }

    imgData.data.set(data);
    enhanceCtx.putImageData(imgData,0,0);

    return new Promise((resolve)=>{
      enhanceCanvas.toBlob(blob=>{
        if(!blob){
          resolve({blob:null,url:null,w,h});
        }else{
          const url = URL.createObjectURL(blob);
          resolve({blob,url,w,h});
        }
      },'image/png');
    });
  }

  async function applyEnhanceSingle(){
    if(!enhanceImg){
      alert('Please select a single image first.');
      return;
    }
    enhanceStatus.textContent = 'Enhancing image (mobile-safe mode)...';
    enhanceStatus.className = 'status';
    enhanceDownloadLink.style.display = 'none';
    metaNew.textContent = '';

    try{
      const opts = getEnhanceOptions();
      const {blob,url,w,h} = await runEnhancementOnImage(enhanceImg, opts);
      if(!blob){
        enhanceStatus.textContent = 'Enhancement failed.';
        enhanceStatus.className = 'status error';
        return;
      }
      enhanceDownloadLink.href = url;
      enhanceDownloadLink.style.display = 'inline-flex';
      metaNew.textContent = `Enhanced: ${w}×${h}px (preview-optimized)`;
      enhanceStatus.textContent = 'Done. Preview updated — you can download the enhanced image.';
      enhanceStatus.className = 'status success';
    }catch(err){
      console.error(err);
      enhanceStatus.textContent = 'Enhancement failed. Try a smaller image or different settings.';
      enhanceStatus.className = 'status error';
    }
  }

  // smart preset similar to “one click AI enhance”
  function autoEnhanceSmart(){
    document.getElementById('enhance-quality').value = 55;
    document.getElementById('enhance-noise').value   = 40;
    document.getElementById('enhance-color').value   = 45;
    document.getElementById('enhance-upscale').value = '1.5';
    document.getElementById('enhance-face').checked  = true;
    document.getElementById('enhance-restore').checked = false;
    document.getElementById('enhance-quality-label').textContent = '55';
    document.getElementById('enhance-noise-label').textContent   = '40';
    document.getElementById('enhance-color-label').textContent   = '45';
    applyEnhanceSingle();
  }

  // batch processing: apply same settings to many images (also capped)
  async function enhanceBatch(){
    const input = document.getElementById('enhance-batch-input');
    const files = Array.from(input.files || []);
    const opts = getEnhanceOptions();
    if(!files.length){
      alert('Select one or more images in the “Batch images” field first.');
      return;
    }
    enhanceStatus.textContent = `Enhancing ${files.length} image(s)... they will download one by one. (Mobile-safe size)`;
    enhanceStatus.className = 'status';

    for(let i=0;i<files.length;i++){
      const file = files[i];
      try{
        enhanceStatus.textContent = `Enhancing image ${i+1} of ${files.length}...`;
        const img = await loadImageFromFile(file);
        const {blob} = await runEnhancementOnImage(img, opts);
        if(blob){
          const nameBase = file.name.replace(/\.[^.]+$/,'') || 'image';
          downloadBlob(blob, `enhanced-${nameBase}.png`);
        }
      }catch(err){
        console.error(err);
      }
    }
    enhanceStatus.textContent = 'Batch processing finished. Check your downloads folder.';
    enhanceStatus.className = 'status success';
  }
  // ---------- 12. PHOTO / PDF → TABLE → CSV (Photo to Excel lite) ----------
  let photoExcelCsvUrl = null;

  function buildCsvFromPlainText(text){
    // 1) split into lines, empty line বাদ
    const lines = text
      .split(/\r?\n/)
      .map(l => l.trim())
      .filter(l => l.length > 0);

    const rows = [];

    for(const line of lines){
      let cells = [];

      if (line.includes('\t')) {
        // tab-separated
        cells = line.split(/\t+/);
      } else if (line.includes('|')) {
        // pipe-separated tables (A | B | C)
        cells = line.split(/\s*\|\s*/);
      } else {
        // default: 2+ space → column
        cells = line.split(/\s{2,}/);
      }

      cells = cells.map(c => c.trim()).filter(c => c.length > 0);
      if(!cells.length) continue;

      // CSV escaping: quote if comma / quote / newline
      const csvCells = cells.map(c=>{
        if(/[",\r\n]/.test(c)){
          return '"' + c.replace(/"/g,'""') + '"';
        }
        return c;
      });

      rows.push(csvCells.join(','));
    }

    return rows.join('\r\n');
  }

  async function runPhotoExcel(){
    const input = document.getElementById('photoExcel-input');
    const file = input.files[0];
    const lang = document.getElementById('photoExcel-lang').value;
    const status = document.getElementById('photoExcel-status');
    const rawOut = document.getElementById('photoExcel-raw');
    const csvOut = document.getElementById('photoExcel-csv');
    const link = document.getElementById('photoExcel-download');

    rawOut.value = '';
    csvOut.value = '';
    link.style.display = 'none';
    link.href = '#';

    if(photoExcelCsvUrl){
      URL.revokeObjectURL(photoExcelCsvUrl);
      photoExcelCsvUrl = null;
    }

    if(!file){
      status.textContent = 'Please select an image or PDF first.';
      status.className = 'status error';
      return;
    }

    status.textContent = 'Preparing OCR...';
    status.className = 'status';

    const T = window.Tesseract;

    try{
      let fullText = '';

      if(file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')){
        // ---- PDF TABLE OCR ----
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({data:arrayBuffer}).promise;
        const totalPages = pdf.numPages;

        for(let pageNum=1; pageNum<=totalPages; pageNum++){
          const page = await pdf.getPage(pageNum);

          // একটু higher DPI = better OCR
          const viewport = page.getViewport({scale: 2.0});
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          await page.render({canvasContext:ctx,viewport}).promise;

          status.textContent = `Running OCR on page ${pageNum} of ${totalPages}...`;

          const result = await T.recognize(canvas, lang, {
            logger: m => {
              if(m.status === 'recognizing text' && m.progress){
                status.textContent = `Page ${pageNum}/${totalPages} – ${(m.progress*100).toFixed(0)}%`;
              }
            }
          });

          const pageText = (result.data.text || '').trim();
          if(pageText.length){
            fullText += (fullText ? '\n\n' : '') + pageText;
          }
        }
      }else{
        // ---- IMAGE TABLE OCR ----
        const dataURL = await readFileAsDataURL(file);
        const img = await loadImageFromDataURL(dataURL);

        // একটু preprocess: grayscale + slight contrast
        const maxDim = 1800;
        const needScale = maxDim / Math.max(img.width, img.height);
        const scale = needScale < 1 ? needScale : 1;
        const w = Math.round(img.width * scale);
        const h = Math.round(img.height * scale);

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = w; canvas.height = h;
        ctx.drawImage(img, 0, 0, w, h);

        let imgData = ctx.getImageData(0,0,w,h);
        let d = imgData.data;
        const c = 1.2;
        const intercept = 128*(1-c);
        for(let i=0;i<d.length;i+=4){
          let r=d[i], g=d[i+1], b=d[i+2];
          let grey = 0.299*r+0.587*g+0.114*b;
          grey = c*grey + intercept + 5;
          grey = Math.max(0,Math.min(255,grey));
          d[i]=d[i+1]=d[i+2]=grey;
        }
        ctx.putImageData(imgData,0,0);

        status.textContent = 'Running OCR on image table...';

        const result = await T.recognize(canvas, lang, {
          logger: m => {
            if(m.status === 'recognizing text' && m.progress){
              status.textContent = `Recognizing text – ${(m.progress*100).toFixed(0)}%`;
            }
          }
        });

        fullText = (result.data.text || '').trim();
      }

      if(!fullText){
        status.textContent = 'No text detected. Try a clearer scan or higher quality image.';
        status.className = 'status error';
        return;
      }

      rawOut.value = fullText;

      // Build CSV from OCR text
      const csv = buildCsvFromPlainText(fullText);
      csvOut.value = csv || '# No table-like structure detected.\n';

      if(csv && csv.trim().length){
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        photoExcelCsvUrl = URL.createObjectURL(blob);
        link.href = photoExcelCsvUrl;
        link.style.display = 'inline-flex';
        status.textContent = 'Done. Check CSV preview and download for Excel.';
        status.className = 'status success';
      }else{
        status.textContent = 'OCR done, but could not detect clear table columns. You can still copy raw text.';
        status.className = 'status';
      }

    }catch(err){
      console.error(err);
      status.textContent = 'Table OCR failed. Try a clearer table or different language.';
      status.className = 'status error';
    }
  }
  // ---------- 11. ID PHOTO MAKER ----------
  let idImg=null;
  let idScale=1;
  let crop = {x:0,y:0,w:0,h:0};
  let dragging=false;
  let dragOffset={x:0,y:0};

  const idContainer=document.getElementById('id-crop-container');
  const idImgEl=document.getElementById('id-img');
  const idCropRect=document.getElementById('id-crop-rect');

  document.getElementById('id-input').addEventListener('change', async (e)=>{
    const file=e.target.files[0];
    const status=document.getElementById('id-status');
    document.getElementById('id-download').style.display='none';
    if(!file){idContainer.style.display='none';status.textContent='';return;}
    try{
      const url=await readFileAsDataURL(file);
      idImg=await loadImageFromDataURL(url);
      idImgEl.src=url;
      idContainer.style.display='block';
      status.textContent='Image loaded. Adjust crop box over the face.';
      status.className='status';
      setTimeout(initIdCrop,50);
    }catch(err){
      console.error(err);
      status.textContent='Could not load image.';
      status.className='status error';
    }
  });

  function initIdCrop(){
    if(!idImg)return;
    const rect=idContainer.getBoundingClientRect();
    const imgRect=idImgEl.getBoundingClientRect();
    idScale=idImg.width/imgRect.width;
    const preset=document.getElementById('id-preset').value.split('x');
    const pw=parseInt(preset[0]),ph=parseInt(preset[1]);
    const aspect=pw/ph;
    let cropW=imgRect.width*0.5;
    let cropH=cropW/aspect;
    if(cropH>imgRect.height*0.7){
      cropH=imgRect.height*0.7;
      cropW=cropH*aspect;
    }
    crop.w=cropW;
    crop.h=cropH;
    crop.x=imgRect.left-rect.left + (imgRect.width-cropW)/2;
    crop.y=imgRect.top-rect.top + (imgRect.height-cropH)/3;
    updateCropRect();
  }
  function updateCropRect(){
    idCropRect.style.left=crop.x+'px';
    idCropRect.style.top=crop.y+'px';
    idCropRect.style.width=crop.w+'px';
    idCropRect.style.height=crop.h+'px';
  }

  idCropRect.addEventListener('mousedown',startDrag);
  idCropRect.addEventListener('touchstart',startDrag,{passive:false});
  window.addEventListener('mousemove',onDrag);
  window.addEventListener('touchmove',onDrag,{passive:false});
  window.addEventListener('mouseup',endDrag);
  window.addEventListener('touchend',endDrag);

  function startDrag(e){
    e.preventDefault();
    dragging=true;
    const pos=getDragPos(e);
    dragOffset.x=pos.x-crop.x;
    dragOffset.y=pos.y-crop.y;
  }
  function getDragPos(e){
    const rect=idContainer.getBoundingClientRect();
    if(e.touches && e.touches[0]){
      return{
        x:e.touches[0].clientX-rect.left,
        y:e.touches[0].clientY-rect.top
      };
    }
    return{
      x:e.clientX-rect.left,
      y:e.clientY-rect.top
    };
  }
  function onDrag(e){
    if(!dragging)return;
    e.preventDefault();
    const pos=getDragPos(e);
    const imgRect=idImgEl.getBoundingClientRect();
    const contRect=idContainer.getBoundingClientRect();
    const minX=imgRect.left-contRect.left;
    const minY=imgRect.top-contRect.top;
    const maxX=minX+imgRect.width-crop.w;
    const maxY=minY+imgRect.height-crop.h;
    crop.x=Math.min(Math.max(pos.x-dragOffset.x,minX),maxX);
    crop.y=Math.min(Math.max(pos.y-dragOffset.y,minY),maxY);
    updateCropRect();
  }
  function endDrag(e){
    if(!dragging)return;
    e.preventDefault();
    dragging=false;
  }

  async function generateIdPhoto(){
    const status=document.getElementById('id-status');
    const link=document.getElementById('id-download');
    link.style.display='none';
    if(!idImg){
      status.textContent='Please select a portrait image first.';
      status.className='status error';
      return;
    }
    const preset=document.getElementById('id-preset').value.split('x');
    const pw=parseInt(preset[0]),ph=parseInt(preset[1]);
    const bg=document.getElementById('id-bg').value;
    let cols=parseInt(document.getElementById('id-cols').value)||1;
    let rows=parseInt(document.getElementById('id-rows').value)||1;
    cols=Math.min(Math.max(cols,1),5);
    rows=Math.min(Math.max(rows,1),6);
    const maxCopies=40;
    let copies=cols*rows;
    if(copies>maxCopies){
      copies=maxCopies;
    }

    const contRect=idContainer.getBoundingClientRect();
    const imgRect=idImgEl.getBoundingClientRect();
    const relX=crop.x - (imgRect.left-contRect.left);
    const relY=crop.y - (imgRect.top-contRect.top);
    const srcX=relX*idScale;
    const srcY=relY*idScale;
    const srcW=crop.w*idScale;
    const srcH=crop.h*idScale;

    const margin=20;
    const gap=20;
    const sheetW = pw*cols + margin*2 + gap*(cols-1);
    const sheetH = ph*rows + margin*2 + gap*(rows-1);

    try{
      const canvas=document.createElement('canvas');
      canvas.width=sheetW;canvas.height=sheetH;
      const ctx=canvas.getContext('2d');

      ctx.fillStyle='#ffffff';
      ctx.fillRect(0,0,sheetW,sheetH);

      let placed=0;
      for(let r=0;r<rows;r++){
        for(let c=0;c<cols;c++){
          if(placed>=copies) break;
          const x = margin + c*(pw+gap);
          const y = margin + r*(ph+gap);
          ctx.fillStyle=bg;
          ctx.fillRect(x,y,pw,ph);
          ctx.drawImage(idImg,srcX,srcY,srcW,srcH,x,y,pw,ph);
          placed++;
        }
      }

      canvas.toBlob(blob=>{
        if(!blob){
          status.textContent='Could not build ID photo sheet.';
          status.className='status error';
          return;
        }
        const url=URL.createObjectURL(blob);
        link.href=url;
        link.style.display='inline-flex';
        status.textContent='ID photo sheet ready. Download below and print.';
        status.className='status success';
      },'image/png');
    }catch(err){
      console.error(err);
      status.textContent='ID photo generation failed.';
      status.className='status error';
    }
  }

  document.getElementById('id-preset').addEventListener('change',()=>{
    if(idImg){initIdCrop();}
  });
</script>
</body>
</html>
